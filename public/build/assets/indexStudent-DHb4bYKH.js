import{o,f as l,b as e,F as E,m as F,c as H,w as k,n as Y,u as w,j as C,g as i,T as z,p as v,h as U,a as h,d as u,Z as G,t as b,i as f,q as j,k as A,v as J,s as K,x as W}from"./app-Dk-Q8yL7.js";import{_ as X}from"./FrontendLayout-DrHqIwa6.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={key:0},ee={class:"flex felx-wrap mb-1"},te=["innerHTML"],se=["innerHTML"],ae={__name:"Pagination",props:{links:Array},setup(d){return(g,L)=>d.links.length>0?(o(),l("div",Q,[e("div",ee,[(o(!0),l(E,null,F(d.links,(y,_)=>(o(),l(E,{key:_},[y.url===null?(o(),l("div",{key:0,class:"mr-1 mb-1 px-4 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:y.label},null,8,te)):(o(),H(w(C),{key:1,class:Y(["mr-1 mb-1 px-4 py-3 text-sm leading-4 border rounded hover:bg-blue-100 hover:text-black focus:border-indigo-500 inline-block focus:text-indigo-500",{"bg-blue-500 text-white":y.active}]),href:y.url},{default:k(()=>[e("span",{innerHTML:y.label},null,8,se)]),_:2},1032,["class","href"]))],64))),128))])])):i("",!0)}},x=d=>(K("data-v-bc9bad47"),d=d(),W(),d),oe={key:0,class:"alert bg-green-200 mt-40 mx-5 py-2 rounded"},le={class:"mt-4 mx-4"},ne={class:"flex justify-between"},re=x(()=>e("h3",null,"Student List",-1)),de={key:0,class:"w-full bg-white border border-gray-200 shadow"},ue=x(()=>e("th",{class:"py-2 px-4 text-left border"},"Option",-1)),ie={key:0},ce={key:0},pe={key:0},ve=x(()=>e("th",{class:"py-4 px-4 text-left border"},"Action",-1)),ye={class:"py-2 px-4 border"},me=["value"],be={class:"py-2 px-4 border"},xe={class:"py-2 px-4 border"},_e={class:"py-2 px-4 border"},he={class:"py-2 px-4 border"},fe=["onClick"],ke={key:1,class:"modal-overlay"},we={class:"modal-content"},ge=x(()=>e("h2",null,"Export Student Data",-1)),Se={key:0},De=x(()=>e("label",{for:"startDate"},"Start Date:",-1)),Te=["min","max"],Ce=x(()=>e("label",{for:"endDate"},"End Date:",-1)),Ee=["min","max"],$e={key:1},Me=x(()=>e("label",{for:"selectedDate"},"Select Date:",-1)),Ne=["min","max"],Oe={class:"float-end"},Re={__name:"indexStudent",props:{students:[Object,Array]},setup(d){const g=d,L=z({}),y=a=>{confirm("Are you sure want to delete this data?")&&L.delete(route("students.destroy",a))},_=v([]),$=v(!1),S=v(""),D=v(""),T=v(""),n=v("weekly");let M;const c=v(""),p=v("asc"),N=U(()=>new Date().toISOString().split("T")[0]),O=U(()=>{const a=new Date;return a.setFullYear(a.getFullYear()-1),a.toISOString().split("T")[0]}),V=U(()=>[...Array.isArray(g.students)?g.students:g.students.data||[]].sort((t,s)=>{if(!c.value)return 0;const m=t[c.value],r=s[c.value];return m<r?p.value==="asc"?-1:1:m>r?p.value==="asc"?1:-1:0})),R=a=>{c.value===a?p.value=p.value==="asc"?"desc":"asc":(c.value=a,p.value="asc")},I=()=>{if(_.value.length===0){alert("Please select at least one score to export.");return}$.value=!0},q=()=>{$.value=!1},B=async()=>{const a={selectedStudents:_.value,reportType:n.value};n.value==="weekly"?(a.startDate=S.value,a.endDate=D.value,M="students-scores.export-weekly"):n.value==="daily"&&(a.selectedDate=T.value,M="students-scores.export-daily");try{const t=await fetch(route(M),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(a)});if(!t.ok){const P=await t.json();throw new Error(P.massage||`Error: ${t.statusText}`)}const s=await t.blob(),m=window.URL.createObjectURL(s),r=document.createElement("a");r.href=m,r.download=`${n.value.toUpperCase()} REPORT ASSESSMENT ${n.value==="daily"?T.value:D.value}.xlsx`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(m),r.remove()}catch(t){console.error("Export failed:",t),alert("Failed to export data. Please try again.")}};return(a,t)=>(o(),l(E,null,[h(w(G),{title:"Students"},{default:k(()=>[u(" Students ")]),_:1}),h(X,null,{default:k(()=>[a.$page.props.flash.message?(o(),l("div",oe,b(a.$page.props.flash.message),1)):i("",!0),e("div",le,[e("div",ne,[re,h(w(C),{href:a.route("students.create"),class:"bg-blue-500 text-white p-3 rounded mb-4"},{default:k(()=>[u("Add New Data")]),_:1},8,["href"])]),V.value.length?(o(),l("table",de,[e("thead",null,[e("tr",null,[ue,e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:t[0]||(t[0]=s=>R("name"))},[u(" Nama "),c.value==="name"?(o(),l("span",ie,b(p.value==="asc"?"↑":"↓"),1)):i("",!0)]),e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:t[1]||(t[1]=s=>R("wave"))},[u(" Gelombang "),c.value==="wave"?(o(),l("span",ce,b(p.value==="asc"?"↑":"↓"),1)):i("",!0)]),e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:t[2]||(t[2]=s=>R("no_test"))},[u(" No Test "),c.value==="no_test"?(o(),l("span",pe,b(p.value==="asc"?"↑":"↓"),1)):i("",!0)]),ve])]),e("tbody",null,[(o(!0),l(E,null,F(V.value,(s,m)=>(o(),l("tr",{key:m},[e("td",ye,[f(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[3]||(t[3]=r=>_.value=r)},null,8,me),[[J,_.value]])]),e("td",be,b(s.name),1),e("td",xe,b(s.wave),1),e("td",_e,b(s.no_test),1),e("td",he,[h(w(C),{href:a.route("students.show",s.id),class:"px-4 oy-1 text-sm bg-blue-300 text-dark me-2 rounded inline-block"},{default:k(()=>[u(" Show ")]),_:2},1032,["href"]),h(w(C),{href:a.route("students.edit",s.id),class:"px-4 oy-1 text-sm bg-green-400 text-dark me-2 rounded inline-block"},{default:k(()=>[u(" Edit ")]),_:2},1032,["href"]),e("button",{type:"submit",class:"px-4 oy-1 text-sm bg-red-500 text-white me-2 rounded inline-block",onClick:r=>y(s.id)}," Delete ",8,fe)])]))),128))])])):i("",!0),e("div",{class:"mb-3"},[e("button",{onClick:I,class:"mt-4 px-4 py-2 bg-blue-500 text-white rounded"}," Export Selected ")]),$.value?(o(),l("div",ke,[e("div",we,[ge,e("label",null,[f(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=s=>n.value=s),value:"weekly"},null,512),[[j,n.value]]),u(" Export Weekly Report ")]),e("label",null,[f(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=s=>n.value=s),value:"daily"},null,512),[[j,n.value]]),u(" Export Daily Report ")]),n.value==="weekly"?(o(),l("div",Se,[De,f(e("input",{type:"date",id:"startDate","onUpdate:modelValue":t[6]||(t[6]=s=>S.value=s),min:O.value,max:N.value,class:"py-1 w-full",required:""},null,8,Te),[[A,S.value]]),Ce,f(e("input",{type:"date",id:"endDate","onUpdate:modelValue":t[7]||(t[7]=s=>D.value=s),min:S.value||O.value,max:N.value,class:"py-1 w-full",required:""},null,8,Ee),[[A,D.value]])])):i("",!0),n.value==="daily"?(o(),l("div",$e,[Me,f(e("input",{type:"date",id:"selectedDate","onUpdate:modelValue":t[8]||(t[8]=s=>T.value=s),min:O.value,max:N.value,class:"py-1 w-full",required:""},null,8,Ne),[[A,T.value]])])):i("",!0),e("button",{onClick:B,class:"mt-4 px-4 py-2 mr-4 bg-green-500 text-white rounded"}," Export "),e("button",{onClick:q,class:"mt-4 px-4 py-2 mr-4 bg-gray-500 text-white rounded"}," Cancel ")])])):i("",!0),e("div",Oe,[h(ae,{class:"mt-4",links:d.students.links},null,8,["links"])])])]),_:1})],64))}},Ve=Z(Re,[["__scopeId","data-v-bc9bad47"]]);export{Ve as default};
