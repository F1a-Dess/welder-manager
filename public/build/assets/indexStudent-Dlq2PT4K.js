import{o as s,f as n,b as e,F as U,m as j,c as K,w as _,n as X,u as A,j as W,g as i,T as Z,h as $,p as g,a as x,d,Z as Q,t as h,i as p,q as R,k as S,s as ee,x as te}from"./app-BPFQK0d1.js";import{_ as le}from"./FrontendLayout-BYuyIMfc.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={key:0},ne={class:"flex felx-wrap mb-1"},oe=["innerHTML"],de=["innerHTML"],re={__name:"Pagination",props:{links:Array},setup(c){return(L,I)=>c.links.length>0?(s(),n("div",se,[e("div",ne,[(s(!0),n(U,null,j(c.links,(b,V)=>(s(),n(U,{key:V},[b.url===null?(s(),n("div",{key:0,class:"mr-1 mb-1 px-4 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:b.label},null,8,oe)):(s(),K(A(W),{key:1,class:X(["mr-1 mb-1 px-4 py-3 text-sm leading-4 border rounded hover:bg-blue-100 hover:text-black focus:border-indigo-500 inline-block focus:text-indigo-500",{"bg-blue-500 text-white":b.active}]),href:b.url},{default:_(()=>[e("span",{innerHTML:b.label},null,8,de)]),_:2},1032,["class","href"]))],64))),128))])])):i("",!0)}},v=c=>(ee("data-v-6bb16a8c"),c=c(),te(),c),ue={key:0,class:"alert bg-green-200 mt-40 mx-5 py-2 rounded"},ie={class:"mt-4 mx-4"},ce={class:"flex justify-between"},pe=v(()=>e("h3",null,"Student List",-1)),ve={key:0,class:"w-full bg-white border border-gray-200 shadow"},ye={class:"py-2 px-4 text-left border"},me=["checked"],ge={key:0},be={key:0},he={key:0},fe=v(()=>e("th",{class:"py-4 px-4 text-left border"},"Action",-1)),xe={class:"py-2 px-4 border"},_e=["value","checked","onChange"],ke={class:"py-2 px-4 border"},De={class:"py-2 px-4 border"},we={class:"py-2 px-4 border"},Se={class:"py-2 px-4 border"},Ae=["onClick"],Le={key:1,class:"modal-overlay"},Ce={class:"modal-content"},Ee=v(()=>e("h2",null,"Export Selected Student Data",-1)),Te=v(()=>e("div",{class:"mt-4"},[e("label",null,"Daily Export Options :")],-1)),$e={key:0,class:"mt-2"},Re=v(()=>e("label",{for:"startDate"},"Start Date:",-1)),We=["min","max"],Ue=v(()=>e("label",{for:"endDate"},"End Date:",-1)),Ve=["min","max"],Ne={key:1,class:"mt-2"},Oe=v(()=>e("label",{for:"selectedWeldingDate"},"Select Date:",-1)),Ie=["min","max"],Me={key:2,class:"mt-2"},je=v(()=>e("label",{for:"selectedLanguageDate"},"Select Date:",-1)),qe=["min","max"],Fe={key:3,class:"mt-2"},Pe=v(()=>e("label",{for:"selectedAttitudeDate"},"Select Date:",-1)),Be=["min","max"],He={class:"float-end"},Ye={__name:"indexStudent",props:{students:[Object,Array]},setup(c){const L=c,I=Z({}),b=a=>{confirm("Are you sure want to delete this data?")&&I.delete(route("students.destroy",a))},V=a=>{const l=r.value.indexOf(a.id);l>-1?r.value.splice(l,1):r.value.push(a.id)},q=a=>{const l=T.value.map(t=>t.id);a.target.checked?l.forEach(t=>{r.value.includes(t)||r.value.push(t)}):r.value=r.value.filter(t=>!l.includes(t))},F=$(()=>{const a=T.value.map(l=>l.id);return a.length>0&&a.every(l=>r.value.includes(l))}),r=g([]),N=g(!1),C=g(""),E=g("");g("");const o=g("weekly"),y=g(""),m=g("asc"),k=$(()=>new Date().toISOString().split("T")[0]),D=$(()=>{const a=new Date;return a.setFullYear(a.getFullYear()-1),a.toISOString().split("T")[0]}),T=$(()=>{const a=Array.isArray(L.students)?L.students:L.students.data||[];return Array.isArray(a)?[...a].sort((l,t)=>{if(!y.value)return 0;const u=l[y.value],f=t[y.value];return u<f?m.value==="asc"?-1:1:u>f?m.value==="asc"?1:-1:0}):[]}),O=a=>{y.value===a?m.value=m.value==="asc"?"desc":"asc":(y.value=a,m.value="asc")},P=()=>{if(r.value.length===0){alert("Please select at least one score to export.");return}N.value=!0},B=()=>{N.value=!1},H=async()=>{const a={selectedStudents:r.value,reportType:o.value};let l,t;switch(o.value){case"weekly":a.startDate=C.value,a.endDate=E.value,t=E.value,l="students-scores.export-weekly";break;case"dailyWelding":a.selectedDate=selectedWeldingDate.value,t=selectedWeldingDate.value,l="students-scores.export-daily";break;case"dailyLanguage":a.selectedDate=selectedLanguageDate.value,t=selectedLanguageDate.value,l="students-scores.export-language";break;case"dailyAttitude":a.selectedDate=selectedAttitudeDate.value,t=selectedAttitudeDate.value,l="students-scores.export-attitude";break;default:alert("Invalid report type selected.");return}try{const u=await fetch(route(l),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(a)});if(!u.ok){const J=await u.json();throw new Error(J.message||`Error: ${u.statusText}`)}const f=await u.blob(),M=window.URL.createObjectURL(f),w=document.createElement("a");w.href=M;const Y={dailyWelding:"Daily Welding Assesment Report",dailyLanguage:"Daily Language Assesment Report",dailyAttitude:"Daily Attitude Assesment Report",weekly:"Weekly Assesment Report"},z=t&&typeof t=="object"?t.value:t,G=`${Y[o.value]} ${z}.xlsx`;w.download=G,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(M),w.remove()}catch(u){console.error("Export failed:",u),alert("Failed to export data. Please try again.")}};return(a,l)=>(s(),n(U,null,[x(A(Q),{title:"Students"},{default:_(()=>[d(" Students ")]),_:1}),x(le,null,{default:_(()=>[a.$page.props.flash.message?(s(),n("div",ue,h(a.$page.props.flash.message),1)):i("",!0),e("div",ie,[e("div",ce,[pe,x(A(W),{href:a.route("students.create"),class:"bg-blue-500 text-white p-3 rounded mb-4"},{default:_(()=>[d("Add New Data")]),_:1},8,["href"])]),T.value.length?(s(),n("table",ve,[e("thead",null,[e("tr",null,[e("th",ye,[d(" Option - Select All "),e("input",{type:"checkbox",onChange:l[0]||(l[0]=t=>q(t)),checked:F.value},null,40,me)]),e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:l[1]||(l[1]=t=>O("name"))},[d(" Nama "),y.value==="name"?(s(),n("span",ge,h(m.value==="asc"?"↑":"↓"),1)):i("",!0)]),e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:l[2]||(l[2]=t=>O("wave"))},[d(" Gelombang "),y.value==="wave"?(s(),n("span",be,h(m.value==="asc"?"↑":"↓"),1)):i("",!0)]),e("th",{class:"py-2 px-4 text-left border cursor-pointer",onClick:l[3]||(l[3]=t=>O("no_test"))},[d(" No Test "),y.value==="no_test"?(s(),n("span",he,h(m.value==="asc"?"↑":"↓"),1)):i("",!0)]),fe])]),e("tbody",null,[(s(!0),n(U,null,j(T.value,(t,u)=>(s(),n("tr",{key:u},[e("td",xe,[e("input",{type:"checkbox",value:t.id,checked:r.value.includes(t.id),onChange:f=>V(t)},null,40,_e)]),e("td",ke,h(t.name),1),e("td",De,h(t.wave),1),e("td",we,h(t.no_test),1),e("td",Se,[x(A(W),{href:a.route("students.show",t.id),class:"px-4 oy-1 text-sm bg-blue-300 text-dark me-2 rounded inline-block"},{default:_(()=>[d(" Show ")]),_:2},1032,["href"]),x(A(W),{href:a.route("students.edit",t.id),class:"px-4 oy-1 text-sm bg-green-400 text-dark me-2 rounded inline-block"},{default:_(()=>[d(" Edit ")]),_:2},1032,["href"]),e("button",{type:"submit",class:"px-4 oy-1 text-sm bg-red-500 text-white me-2 rounded inline-block",onClick:f=>b(t.id)}," Delete ",8,Ae)])]))),128))])])):i("",!0),e("div",{class:"mb-3"},[e("button",{onClick:P,class:"mt-4 px-4 py-2 bg-blue-500 text-white rounded"}," Export Selected ")]),N.value?(s(),n("div",Le,[e("div",Ce,[Ee,e("label",null,[p(e("input",{type:"radio","onUpdate:modelValue":l[4]||(l[4]=t=>o.value=t),value:"weekly"},null,512),[[R,o.value]]),d(" Export Weekly Report ")]),Te,e("div",null,[e("label",null,[p(e("input",{type:"radio","onUpdate:modelValue":l[5]||(l[5]=t=>o.value=t),value:"dailyWelding"},null,512),[[R,o.value]]),d(" Export Daily Welding Report ")])]),e("div",null,[e("label",null,[p(e("input",{type:"radio","onUpdate:modelValue":l[6]||(l[6]=t=>o.value=t),value:"dailyLanguage"},null,512),[[R,o.value]]),d(" Export Daily Language Report ")])]),e("div",null,[e("label",null,[p(e("input",{type:"radio","onUpdate:modelValue":l[7]||(l[7]=t=>o.value=t),value:"dailyAttitude"},null,512),[[R,o.value]]),d(" Export Daily Attitude Report ")])]),o.value==="weekly"?(s(),n("div",$e,[Re,p(e("input",{type:"date",id:"startDate","onUpdate:modelValue":l[8]||(l[8]=t=>C.value=t),min:D.value,max:k.value,class:"py-1 w-full",required:""},null,8,We),[[S,C.value]]),Ue,p(e("input",{type:"date",id:"endDate","onUpdate:modelValue":l[9]||(l[9]=t=>E.value=t),min:C.value||D.value,max:k.value,class:"py-1 w-full",required:""},null,8,Ve),[[S,E.value]])])):i("",!0),o.value==="dailyWelding"?(s(),n("div",Ne,[Oe,p(e("input",{type:"date",id:"selectedWeldingDate","onUpdate:modelValue":l[10]||(l[10]=t=>a.selectedWeldingDate=t),min:D.value,max:k.value,class:"py-1 w-full",required:""},null,8,Ie),[[S,a.selectedWeldingDate]])])):i("",!0),o.value==="dailyLanguage"?(s(),n("div",Me,[je,p(e("input",{type:"date",id:"selectedLanguageDate","onUpdate:modelValue":l[11]||(l[11]=t=>a.selectedLanguageDate=t),min:D.value,max:k.value,class:"py-1 w-full",required:""},null,8,qe),[[S,a.selectedLanguageDate]])])):i("",!0),o.value==="dailyAttitude"?(s(),n("div",Fe,[Pe,p(e("input",{type:"date",id:"selectedAttitudeDate","onUpdate:modelValue":l[12]||(l[12]=t=>a.selectedAttitudeDate=t),min:D.value,max:k.value,class:"py-1 w-full",required:""},null,8,Be),[[S,a.selectedAttitudeDate]])])):i("",!0),e("button",{onClick:H,class:"mt-4 px-4 py-2 mr-4 bg-green-500 text-white rounded"}," Export "),e("button",{onClick:B,class:"mt-4 px-4 py-2 mr-4 bg-gray-500 text-white rounded"}," Cancel ")])])):i("",!0),e("div",He,[x(re,{class:"mt-4",links:c.students.links},null,8,["links"])])])]),_:1})],64))}},Ke=ae(Ye,[["__scopeId","data-v-6bb16a8c"]]);export{Ke as default};
